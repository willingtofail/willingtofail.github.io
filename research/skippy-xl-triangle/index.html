<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">	<head>		<title>Exhaustive search for a solution to a Skippy XL puzzle | Willing To Fail</title>		<meta name="generator" content="Frontier v10.1a10 10.1a10 MacOS" /><meta http-equiv="content-type" content="text/html; charset=utf-8" />		<link rel="stylesheet" href="../../default.css" type="text/css">				<link rel="stylesheet" href="../../nC.css" type="text/css">						</head>	<body bgcolor="#FFFFFF" alink="#008000" vlink="#800080" link="#0000FF" text="#000000">		<div id="page">			<div id="logo"><img src="../../images/wtf-banner-580x130.png" height="130" width="580" id="logo-image" alt="wtf-banner-580x130 picture" border="0"/></div>			<div id="content">												<div id="nCSect1" class="nCSect">				<h1 class="nCLevel0">Motivation</h1>				<p id="nCSect1Para1" class="nCPara1 nCSectPara1 nCLevel1"><img src="images/skippy-triangle.jpg" height="35%" width="35%" align="right" style="padding-left: 0.5em" alt="skippy-triangle picture" border="0"/>I've been playing Skippy Lite and Skippy XL on my iPhone since I got it. I've solved many of the boards, but I could not find a solution to the triangle board pictured here.</p>				<p id="nCSect1Para2" class="nCPara2 nCSectPara2 nCLevel1">After many hours wasted getting no closer than having 2 balls left, I decided it would take me less time to write a program to find a solution (or show there was no solution) than to actually solve it myself.</p>				<p id="nCSect1Para3" class="nCPara3 nCSectPara3 nCLevel1">I have access to the <a href="http://www.csc.uvic.ca/">UVic Department of Computer Science</a>'s 42-node IBM BladeCenter cluster. I installed the open-source <a href="http://discoproject.org/">Disco</a> MapReduce system on it a few weeks ago for a school project. I knew an exhaustive search would have exponential growth but with 160 cores available for brute force computation, an answer was very attainable.</p>				<p id="nCSect1Para4" class="nCPara4 nCSectPara4 nCLevel1">Disco is written in <a href="http://www.erlang.org/">Erlang</a> and <a href="http://www.python.org/">Python</a>. Disco MapReduce jobs are typically written in Python.</p>				</div>				<div id="nCSect2" class="nCSect">				<h1 class="nCLevel0">Finding a solution</h1>				<p id="nCSect2Para1" class="nCPara5 nCSectPara1 nCLevel1">Simple: make every possible sequence of moves to see if any of those sequences is long enough to have one ball remaining.</p>				<p id="nCSect2Para2" class="nCPara6 nCSectPara2 nCLevel1">Each move removes one ball, so a solution removes 26 balls in 26 moves.</p>				</div>				<div id="nCSect3" class="nCSect">				<h1 class="nCLevel0">Symmetry to the rescue</h1>				<p id="nCSect3Para1" class="nCPara7 nCSectPara1 nCLevel1">Thankfully the board has symmetries - six to be exact. The board looks the same if it is rotated 120 or 240 degrees, or flipped upon any of three axes from a point through the opposite edge. This fact will be exploited to avoid searching many duplicate puzzles.</p>				</div>				<div id="nCSect4" class="nCSect">				<h1 class="nCLevel0">Using MapReduce to simply eliminate duplicates</h1>				<p id="nCSect4Para1" class="nCPara8 nCSectPara1 nCLevel1">A MapReduce framework requires two pure functions, map and reduce. The map function accepts data and outputs one or more intermediate key-value pairs. The framework collects all the pairs with the same keys and calls the reduce function for each key with all of its corresponding values.</p>				<p id="nCSect4Para2" class="nCPara9 nCSectPara2 nCLevel1">To find a solution, I executed a MapReduce job 26 times, the number of moves required to see if there exists a puzzle with two balls <em>and</em> available moves. (I've found plenty of puzzles with two balls but no available moves! <img src="../../images/sidesmiley.gif" height="11" width="11" alt="sidesmiley picture" border="0"/>)</p>				<p id="nCSect4Para3" class="nCPara10 nCSectPara3 nCLevel1">The first iteration's map function has only one input record - the puzzle in its initial state with no moves taken. The output of the reduce function is the input for the second iteration. The output of the twenty-six iterations would contain all the solutions (excluding duplicates due to symmetry since they are discarded).</p>				</div>				<div id="nCSect5" class="nCSect">				<h1 class="nCLevel0">The map function</h1>				<p id="nCSect5Para1" class="nCPara11 nCSectPara1 nCLevel1">The map function accepts a puzzle, which includes the state of the board and the sequence of moves taken to transition to that state.</p>				<p id="nCSect5Para2" class="nCPara12 nCSectPara2 nCLevel1">I denoted a puzzle by a Python dictionary containing two keys: 'board' and 'moves'. The 'board' key points to a list of 28 boolean values - True if a hole contains a ball, False otherwise. the 'moves' key points to a list of lists. Each sub-list contains 3 integers:</p>				<p id="nCSect5Para3" class="nCPara13 nCSectPara3 nCLevel1">The number of the hole: whose ball jumps, whose ball is jumped over, and the ball lands in. For example, [0, 1, 3] means the ball in hole 0 jumps the ball in hole 1 to land in hole 3.</p>				<p id="nCSect5Para4" class="nCPara14 nCSectPara4 nCLevel1">The map function simply generates a new puzzle for each available move. The output key is the "signature" for the generated puzzle. The output value is the generated puzzle.</p>				<div id="nCSect6" class="nCSect">				<h2 class="nCLevel1">Finding available moves</h2>				<p id="nCSect6Para1" class="nCPara15 nCSectPara1 nCLevel2">This is actually very simple!</p>				<p id="nCSect6Para2" class="nCPara16 nCSectPara2 nCLevel2">The board is a 28 element array of booleans and a move is 3 integers. A move [x, y, z] is available if puzzle['board'][x] is True and puzzle['board'][y] is True and puzzle['board'][z] is False.</p>				<p id="nCSect6Para3" class="nCPara17 nCSectPara3 nCLevel2">The set of possible moves on the board is quite small (12 holes have two possible moves, the centre hole has six, the rest have four each).</p>				</div>				<div id="nCSect7" class="nCSect">				<h2 class="nCLevel1">Calculating the signature</h2>				<p id="nCSect7Para1" class="nCPara18 nCSectPara1 nCLevel2">Remember the six symmetries? This is where we take advantage of them to speed our way to the solution.</p>				<p id="nCSect7Para2" class="nCPara19 nCSectPara2 nCLevel2">A signature is a simple 28 character encoding of the puzzle. Enumerate the holes; each character in the string is a '*' or a 'O' depending on whether or not a ball exists in the corresponding hole. The signature of a puzzle comes from the configuration of the board which provides the lexicographically smallest encoding.</p>				<p id="nCSect7Para3" class="nCPara20 nCSectPara3 nCLevel2">Six permutations corresponding to zero degrees of rotation, 120 degrees of rotation, 240 degrees of rotation, and reflection upon each of three axes are used to find the smallest encoding. Rather than generating six complete signatures, permutations is tested against another for as few spaces as required to determine the smallest.</p>				<p id="nCSect7Para4" class="nCPara21 nCSectPara4 nCLevel2">The result is, if two puzzles with the same number of balls left have the same signature, it means either their board is identical or they can be made identical by performing one of the 5 rotation/reflection transformations. There is no point in exploring both since their potential for a solution is also identical.</p>				</div>				<p id="nCSect7Para5" class="nCPara22 nCSectPara5 nCLevel1">The number of available moves for a puzzle is quite small when the board is nearly full or nearly empty, but much larger when approximately half of the balls remain.</p>				<p id="nCSect7Para6" class="nCPara23 nCSectPara6 nCLevel1">Note that if a puzzle has no available moves, map will not generate any output for it, and thus failed games simply "die" naturally and generate no work for subsequent iterations.</p>				</div>				<div id="nCSect8" class="nCSect">				<h1 class="nCLevel0">The reduce function</h1>				<p id="nCSect8Para1" class="nCPara24 nCSectPara1 nCLevel1">TODO: Only output one puzzle per signature.</p>				</div>				<div id="nCSect9" class="nCSect">				<h1 class="nCLevel0">Between each iteration</h1>				<p id="nCSect9Para1" class="nCPara25 nCSectPara1 nCLevel1">TODO: Data must be collected and distributed to the nodes for the next iteration</p>				</div>				<div id="nCSect10" class="nCSect">				<h1 class="nCLevel0">Result</h1>				<p id="nCSect10Para1" class="nCPara26 nCSectPara1 nCLevel1">TODO: Must be verified, but no solution was found.</p>				</div>				</div>			<div id="left-column">				<div id="navigation">					<ul class="nav-links">						<li><a href="../../index.html">Home</a></li>						<li><a href="../../about.html">About</a></li>						<li><a href="../../contact.html">Contact</a></li>						<li><a href="../../links/index.html">Links</a></li>						<!-- <li><a href="../../software/index.html">Software</a></li> -->						<li><a href="../../research/index.html">Research</a></li>						<li><a href="http://jim.roepcke.com/">Jim's Weblog</a></li>						</ul>					</div>				</div>			</div>		<div id="footer">			<p class="update">				This page was last built on Thu, Dec 18, 2008 at 12:00:38 AM with <a href="http://frontierkernel.org/">Frontier</a> on <a href="http://macos.apple.com/">Mac OS X</a>. 				</p>			<p class="update">				Thanks for checking it out! Jim Roepcke				</p>			</div>		</body>	</html>